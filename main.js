(()=>{"use strict";var t={56:(t,e,i)=>{t.exports=function(t){var e=i.nc;e&&t.setAttribute("nonce",e)}},72:t=>{var e=[];function i(t){for(var i=-1,s=0;s<e.length;s++)if(e[s].identifier===t){i=s;break}return i}function s(t,s){for(var l={},n=[],r=0;r<t.length;r++){var o=t[r],c=s.base?o[0]+s.base:o[0],h=l[c]||0,d="".concat(c," ").concat(h);l[c]=h+1;var p=i(d),u={css:o[1],media:o[2],sourceMap:o[3],supports:o[4],layer:o[5]};if(-1!==p)e[p].references++,e[p].updater(u);else{var m=a(u,s);s.byIndex=r,e.splice(r,0,{identifier:d,updater:m,references:1})}n.push(d)}return n}function a(t,e){var i=e.domAPI(e);return i.update(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap&&e.supports===t.supports&&e.layer===t.layer)return;i.update(t=e)}else i.remove()}}t.exports=function(t,a){var l=s(t=t||[],a=a||{});return function(t){t=t||[];for(var n=0;n<l.length;n++){var r=i(l[n]);e[r].references--}for(var o=s(t,a),c=0;c<l.length;c++){var h=i(l[c]);0===e[h].references&&(e[h].updater(),e.splice(h,1))}l=o}}},113:t=>{t.exports=function(t,e){if(e.styleSheet)e.styleSheet.cssText=t;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(t))}}},314:t=>{t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var i="",s=void 0!==e[5];return e[4]&&(i+="@supports (".concat(e[4],") {")),e[2]&&(i+="@media ".concat(e[2]," {")),s&&(i+="@layer".concat(e[5].length>0?" ".concat(e[5]):""," {")),i+=t(e),s&&(i+="}"),e[2]&&(i+="}"),e[4]&&(i+="}"),i})).join("")},e.i=function(t,i,s,a,l){"string"==typeof t&&(t=[[null,t,void 0]]);var n={};if(s)for(var r=0;r<this.length;r++){var o=this[r][0];null!=o&&(n[o]=!0)}for(var c=0;c<t.length;c++){var h=[].concat(t[c]);s&&n[h[0]]||(void 0!==l&&(void 0===h[5]||(h[1]="@layer".concat(h[5].length>0?" ".concat(h[5]):""," {").concat(h[1],"}")),h[5]=l),i&&(h[2]?(h[1]="@media ".concat(h[2]," {").concat(h[1],"}"),h[2]=i):h[2]=i),a&&(h[4]?(h[1]="@supports (".concat(h[4],") {").concat(h[1],"}"),h[4]=a):h[4]="".concat(a)),e.push(h))}},e}},540:t=>{t.exports=function(t){var e=document.createElement("style");return t.setAttributes(e,t.attributes),t.insert(e,t.options),e}},601:t=>{t.exports=function(t){return t[1]}},659:t=>{var e={};t.exports=function(t,i){var s=function(t){if(void 0===e[t]){var i=document.querySelector(t);if(window.HTMLIFrameElement&&i instanceof window.HTMLIFrameElement)try{i=i.contentDocument.head}catch(t){i=null}e[t]=i}return e[t]}(t);if(!s)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");s.appendChild(i)}},825:t=>{t.exports=function(t){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var e=t.insertStyleElement(t);return{update:function(i){!function(t,e,i){var s="";i.supports&&(s+="@supports (".concat(i.supports,") {")),i.media&&(s+="@media ".concat(i.media," {"));var a=void 0!==i.layer;a&&(s+="@layer".concat(i.layer.length>0?" ".concat(i.layer):""," {")),s+=i.css,a&&(s+="}"),i.media&&(s+="}"),i.supports&&(s+="}");var l=i.sourceMap;l&&"undefined"!=typeof btoa&&(s+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(l))))," */")),e.styleTagTransform(s,t,e.options)}(e,t,i)},remove:function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(e)}}}},944:(t,e,i)=>{i.d(e,{A:()=>r});var s=i(601),a=i.n(s),l=i(314),n=i.n(l)()(a());n.push([t.id,"@import url(https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&family=Sarina&display=swap);"]),n.push([t.id,'* {\n  margin: 0;\n  padding: 0;\n  font-family:\n    system-ui,\n    -apple-system,\n    BlinkMacSystemFont,\n    "Segoe UI",\n    Roboto,\n    Oxygen,\n    Ubuntu,\n    Cantarell,\n    "Open Sans",\n    "Helvetica Neue",\n    sans-serif;\n  box-sizing: border-box;\n}\n\n:root {\n  --cell-size: 3rem;\n  --background-color: #0e223b;\n  --text-color: #ff7b00;\n  --board-color: #2d4564;\n  --hit-color: #ff0000;\n  --miss-color: white;\n  --ship-color: #a0a0a0;\n  --ship-placing-color: #ff7b00;\n}\n\n.flex {\n  display: flex;\n}\n\n.column {\n  flex-direction: column;\n}\n\n.hide {\n  display: none !important;\n}\n\n.hit {\n  position: relative;\n}\n\n.hit::after {\n  content: "";\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  width: calc(var(--cell-size) / 2);\n  height: calc(var(--cell-size) / 2);\n  border-radius: 50%;\n  transform: translate(-50%, -50%);\n  z-index: 1;\n  background-color: var(--hit-color);\n}\n\n.miss {\n  position: relative;\n}\n\n.miss::after {\n  content: "";\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  width: calc(var(--cell-size) / 2);\n  height: calc(var(--cell-size) / 2);\n  border-radius: 50%;\n  transform: translate(-50%, -50%);\n  z-index: 1;\n  background-color: var(--miss-color);\n}\n\n.selected {\n  background-color: var(--ship-placing-color) !important;\n}\n\n.ship-placing {\n  background-color: var(--ship-placing-color);\n}\n\n.ship-placed {\n  background-color: var(--ship-color);\n}\n\n.targeted {\n  position: relative;\n}\n\n.targeted::after {\n  content: "";\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  width: calc(var(--cell-size) / 2);\n  height: calc(var(--cell-size) / 2);\n  border-radius: 50%;\n  transform: translate(-50%, -50%);\n  z-index: 1;\n  background-color: var(--ship-placing-color);\n}\n\nbody {\n  height: 100vh;\n  justify-content: space-between;\n  background-color: var(--background-color);\n}\n\nh1 {\n  text-align: center;\n  color: var(--text-color)\n}\n\n#game {\n  width: calc(100vw * 2 / 3);\n  margin: auto auto;\n  justify-content: space-between;\n}\n\n.board {\n  display: grid;\n  grid-template-columns: repeat(10, var(--cell-size));\n  grid-template-rows: repeat(10, var(--cell-size));\n  margin: auto;\n  border: 1px solid #000;\n  background-color: var(--board-color);\n}\n\n.cell {\n  width: var(--cell-size);\n  height: var(--cell-size);\n  border: 1px solid #000;\n}\n\n#ships {\n  width: calc(10 * var(--cell-size));\n  margin: 0 auto;\n  justify-content: flex-start;\n  gap: calc(var(--cell-size) / 2);\n}\n\n.ship {\n  height: var(--cell-size);\n  border: 1px solid #000;\n  background-color: var(--ship-color);\n  display: flex;\n  align-items: center;\n}\n\n#buttons {\n  width: calc(100vw * 2 / 3);\n  margin: auto auto;\n  justify-content: center;\n  gap: calc(var(--cell-size) / 2);\n}\n\nbutton {\n  width: 8rem;\n  height: 8rem;\n  border: 2px solid #000;\n  border-radius: 4rem;\n  background-color: var(--hit-color);\n  color: white;\n  font-size: 1rem;\n  font-weight: 600;\n}',""]);const r=n}},e={};function i(s){var a=e[s];if(void 0!==a)return a.exports;var l=e[s]={id:s,exports:{}};return t[s](l,l.exports,i),l.exports}i.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return i.d(e,{a:e}),e},i.d=(t,e)=>{for(var s in e)i.o(e,s)&&!i.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:e[s]})},i.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),i.nc=void 0;var s=i(72),a=i.n(s),l=i(825),n=i.n(l),r=i(659),o=i.n(r),c=i(56),h=i.n(c),d=i(540),p=i.n(d),u=i(113),m=i.n(u),f=i(944),v={};v.styleTagTransform=m(),v.setAttributes=h(),v.insert=o().bind(null,"head"),v.domAPI=n(),v.insertStyleElement=p(),a()(f.A,v),f.A&&f.A.locals&&f.A.locals;class g{#t;#e=0;#i=!1;constructor(t){this.#t=t}hit(){if(this.isSunk())throw new Error("Ship is already sunk");this.#e++}isSunk(){return this.#e>=this.#t&&(this.#i=!0),this.#i}get size(){return this.#t}}class k{#s=Array.from({length:10},(()=>Array(10).fill({ship:null,hit:!1})));#a=[];constructor(t){t.forEach((({x:t,y:e,isVertical:i,size:s})=>{const a=new g(s);this.#a.push(a),this.#l(t,e,i,this.#a.length-1)}))}#l(t,e,i,s){const a=this.#a[s].size;if(i){if(e+a>10)throw new Error("Ship cannot be placed outside the board");for(let i=0;i<a;i++){if(null!==this.#s[e+i][t].ship)throw new Error("Ship cannot be placed on top of another ship");this.#s[e+i][t]={ship:s,hit:!1}}}else{if(t+a>10)throw new Error("Ship cannot be placed outside the board");for(let i=0;i<a;i++){if(null!==this.#s[e][t+i].ship)throw new Error("Ship cannot be placed on top of another ship");this.#s[e][t+i]={ship:s,hit:!1}}}}receiveAttack(t,e){if(t<0||t>=10||e<0||e>=10)throw new Error("Attack is out of bounds");const i=this.#s[e][t];if(i.hit)throw new Error("Attack already taken");if(this.#s[e][t]={ship:i.ship,hit:!0},null!==i.ship){let t=this.#a[i.ship];return t.hit(),t.isSunk()?i.ship.toString():"hit"}return"miss"}allShipsSunk(){return this.#a.every((t=>t.isSunk()))}get board(){return this.#s}}class b{#n;#r;constructor(t,e){this.#n=t,this.#r=new k(e)}receiveAttack(t,e){return this.#r.receiveAttack(t,e)}allShipsSunk(){return this.#r.allShipsSunk()}get name(){return this.#n}}class y{#s=Array.from({length:10},(()=>Array(10).fill({hit:null})));#o=Array.from({length:10},(()=>Array(10).fill(0)));#a;#c=null;#h=!1;#d=[];#p=0;#u;constructor(t){t&&0!==t.length||(t=[{id:0,size:5},{id:1,size:4},{id:2,size:3},{id:3,size:3},{id:4,size:2}]),this.#a=[...t],this.#u=Math.max(...t.map((t=>t.size))),this.#m()}placeShips(){const t=[],e=Array.from({length:10},(()=>Array(10).fill(!0)));return this.#a.forEach((i=>{let s=Math.floor(10*Math.random()),a=Math.floor(10*Math.random()),l=Math.random()<.5;for(;!this.#f(e,{x:s,y:a,isVertical:l,size:i.size});)s=Math.floor(10*Math.random()),a=Math.floor(10*Math.random()),l=Math.random()<.5;t.push({x:s,y:a,isVertical:l,size:i.size});for(let t=0;t<i.size;t++)l?e[a+t][s]=!1:e[a][s+t]=!1})),t}dumbAttack(){let t=Math.floor(10*Math.random()),e=Math.floor(10*Math.random());for(;null!=this.#s[e][t].hit;)t=Math.floor(10*Math.random()),e=Math.floor(10*Math.random());return this.#c={x:t,y:e},{x:t,y:e}}smartAttack(){let t=-1,e=null;for(let i=0;i<10;i++)for(let s=0;s<10;s++)this.#o[i][s]>t&&null===this.#s[i][s].hit&&(t=this.#o[i][s],e={x:s,y:i});return null===e&&(e=this.dumbAttack()),this.#c=e,e}update(t){const{x:e,y:i}=this.#c;if("miss"===t)this.#s[i][e]={hit:!1};else if("hit"===t)this.#s[i][e]={hit:!0},this.#h=!0,this.#d.push({...this.#c});else{this.#s[i][e]={hit:!0},this.#d.push({...this.#c});const s=parseInt(t),a=this.#a.find((t=>t.id===s));if(a&&(this.#p+=a.size,this.#a=this.#a.filter((t=>t.id!==s)),this.#d.length<=this.#p&&(this.#h=!1,this.#d=[],this.#p=0)),!(this.#a.length>0))return void(this.#u=0);this.#u=Math.max(...this.#a.map((t=>t.size)))}this.#o=Array.from({length:10},(()=>Array(10).fill(0))),this.#v(),this.#h&&this.#u>0&&this.#g()}#m(){this.#a.forEach((t=>{for(let e=0;e<100;e++){const i=e%10,s=Math.floor(e/10);if(t.size+i<=10)for(let e=0;e<t.size;e++)this.#o[s][i+e]++;if(t.size+s<=10)for(let e=0;e<t.size;e++)this.#o[s+e][i]++}}))}#v(){this.#a.forEach((t=>{for(let e=0;e<10;e++)for(let i=0;i<=10-t.size;i++){let s=!0;for(let a=0;a<t.size;a++)if(null!==this.#s[e][i+a].hit){s=!1;break}if(s)for(let s=0;s<t.size;s++)this.#o[e][i+s]++}for(let e=0;e<10;e++)for(let i=0;i<=10-t.size;i++){let s=!0;for(let a=0;a<t.size;a++)if(null!==this.#s[i+a][e].hit){s=!1;break}if(s)for(let s=0;s<t.size;s++)this.#o[i+s][e]++}}))}#g(){this.#d.forEach((t=>{const{x:e,y:i}=t;for(let t=1;t<this.#u&&e+t<10;t++)if(null===this.#s[i][e+t].hit)this.#o[i][e+t]+=50;else if(!1===this.#s[i][e+t].hit)break;for(let t=1;t<this.#u&&e-t>=0;t++)if(null===this.#s[i][e-t].hit)this.#o[i][e-t]+=50;else if(!1===this.#s[i][e-t].hit)break;for(let t=1;t<this.#u&&i+t<10;t++)if(null===this.#s[i+t][e].hit)this.#o[i+t][e]+=50;else if(!1===this.#s[i+t][e].hit)break;for(let t=1;t<this.#u&&i-t>=0;t++)if(null===this.#s[i-t][e].hit)this.#o[i-t][e]+=50;else if(!1===this.#s[i-t][e].hit)break}))}#f(t,e){const{x:i,y:s,isVertical:a,size:l}=e;if(a){if(s+l>10)return!1;for(let e=0;e<l;e++)if(!t[s+e][i])return!1}else{if(i+l>10)return!1;for(let e=0;e<l;e++)if(!t[s][i+e])return!1}return!0}}class S{#k=[{id:0,name:"Carrier",size:5},{id:1,name:"Battleship",size:4},{id:2,name:"Destroyer",size:3},{id:3,name:"Submarine",size:3},{id:4,name:"Patrol Boat",size:2}];#b=new y(this.#k);#y;#S=new b("Computer",this.#b.placeShips());#C;#L;#z=[];#x;#P=[];#B;#E=[];#w=new Array(this.#k.length).fill(null);#A;#M;#q;#T;#V;#I;#j;#D;#R=new Map;#O=new Map;constructor(){this.#L=document.querySelector("#player-board"),this.#x=document.querySelector("#computer-board"),this.#B=document.querySelector("#ships"),this.#q=document.querySelector("#place"),this.#T=document.querySelector("#rotate"),this.#V=document.querySelector("#clear"),this.#I=document.querySelector("#random"),this.#j=document.querySelector("#start"),this.#D=document.querySelector("#attack"),this.#q.addEventListener("click",this.#N.bind(this)),this.#T.addEventListener("click",this.#$.bind(this)),this.#V.addEventListener("click",this.#U.bind(this)),this.#I.addEventListener("click",this.#F.bind(this)),this.#j.addEventListener("click",this.#H.bind(this)),this.#D.addEventListener("click",this.#Y.bind(this)),document.addEventListener("keyup",(t=>{"Enter"===t.key?this.#M?this.#N():this.#C&&this.#Y():"Escape"===t.key&&(this.#A?this.#U():this.#C&&(this.#P[10*this.#C.y+this.#C.x].classList.remove("selected"),this.#C=null,this.#D.disabled=!0))})),this.#q.disabled=!0,this.#T.disabled=!0,this.#j.disabled=!0,this.#D.disabled=!0;for(let t=0;t<100;t++){const e=document.createElement("div");e.id=`player-cell-${t.toString().padStart(2,"0")}`,e.classList.add("cell"),e.classList.add("player-cell"),e.dataset.cell=t,this.#L.appendChild(e),this.#z.push(e);const i=document.createElement("div");i.id=`computer-cell-${t.toString().padStart(2,"0")}`,i.classList.add("cell"),i.classList.add("computer-cell"),i.dataset.cell=t,this.#x.appendChild(i),this.#P.push(i)}this.#k.forEach((t=>{const e=document.createElement("div");e.id=`ship-${t.id}`,e.classList.add("ship"),e.dataset.ship=t.id,e.innerText=t.name,e.style.width=`calc(${t.size} * var(--cell-size))`,this.#B.appendChild(e),this.#E.push(e),e.addEventListener("click",this.#_.bind(this))}))}#_(t){this.#A&&(this.#E[this.#A].classList.remove("selected"),this.#M&&(this.#J(),this.#M=null)),this.#A=t.target.dataset.ship,t.target.classList.add("selected"),this.#z.forEach((t=>{if(!t.classList.contains("ship-placed")){const e=this.#G.bind(this);this.#R.set(t,e),t.addEventListener("click",e)}}))}#G(t){const e=t.target.dataset.cell,i=e%10,s=Math.floor(e/10),a=this.#k[this.#A].size,l=!!this.#M&&this.#M.isVertical;l&&s+a>10||!l&&i+a>10||(this.#M&&this.#J(),this.#M={x:i,y:s,isVertical:l,size:a},this.#K(),this.#q.disabled=!1,this.#T.disabled=!1)}#$(){this.#J(),this.#M.isVertical=!this.#M.isVertical;const t=this.#M.x,e=this.#M.y,i=this.#M.size,s=this.#M.isVertical;s&&e+i>10?this.#M.y=10-i:!s&&t+i>10&&(this.#M.x=10-i),this.#K()}#N(){this.#w[this.#A]=this.#M,this.#E[this.#A].classList.remove("selected"),this.#E[this.#A].classList.add("hide"),this.#q.disabled=!0,this.#T.disabled=!0,this.#z.forEach((t=>{t.classList.contains("ship-placing")&&(t.classList.remove("ship-placing"),t.classList.add("ship-placed"));const e=this.#R.get(t);e&&(t.removeEventListener("click",e),this.#R.delete(t))})),this.#w.every((t=>null!==t))&&(this.#B.classList.add("hide"),this.#j.disabled=!1,this.#j.classList.remove("hide"),this.#q.classList.add("hide"),this.#T.classList.add("hide")),this.#M=null,this.#A=null}#U(){this.#w.forEach((t=>{if(t){const e=t.x,i=t.y;for(let s=0;s<t.size;s++)t.isVertical?this.#z[10*(i+s)+e].classList.remove("ship-placed"):this.#z[10*i+e+s].classList.remove("ship-placed")}})),this.#w.fill(null),this.#A&&(this.#A=null,this.#M&&(this.#J(),this.#M=null)),this.#E.forEach((t=>{t.classList.remove("hide","selected")})),this.#B.classList.remove("hide"),this.#q.classList.remove("hide"),this.#T.classList.remove("hide"),this.#j.classList.add("hide"),this.#q.disabled=!0,this.#T.disabled=!0,this.#j.disabled=!0,this.#z.forEach((t=>{const e=this.#R.get(t);e&&(t.removeEventListener("click",e),this.#R.delete(t))}))}#F(){this.#U(),this.#w=this.#b.placeShips(),this.#w.forEach(((t,e)=>{this.#M=t,this.#A=e,this.#K(),this.#N()}))}#H(){this.#y=new b("Player",this.#w),this.#j.classList.add("hide"),this.#V.classList.add("hide"),this.#I.classList.add("hide"),this.#j.disabled=!0,this.#V.disabled=!0,this.#I.disabled=!0,this.#x.classList.remove("hide"),this.#D.classList.remove("hide"),this.#P.forEach((t=>{const e=this.#Q.bind(this);this.#O.set(t,e),t.addEventListener("click",e)}))}#Q(t){const e=t.target.dataset.cell,i=e%10,s=Math.floor(e/10);if(this.#C){if(this.#C.x===i&&this.#C.y===s)return t.target.classList.remove("targeted"),this.#C=null,void(this.#D.disabled=!0);this.#P[10*this.#C.y+this.#C.x].classList.remove("targeted"),this.#C={x:i,y:s},t.target.classList.add("targeted")}else this.#C={x:i,y:s},t.target.classList.add("targeted");this.#D.disabled=!1}#Y(){const t=this.#P[10*this.#C.y+this.#C.x],e=this.#O.get(t);e&&(t.removeEventListener("click",e),this.#O.delete(t)),this.#D.disabled=!0,t.classList.remove("targeted");const i=this.#S.receiveAttack(this.#C.x,this.#C.y);if("miss"===i?t.classList.add("miss"):"hit"===i?t.classList.add("hit"):(t.classList.add("hit"),alert(`You sunk my ${this.#k[parseInt(i)].name}!`)),this.#C=null,this.#S.allShipsSunk())return this.#y.allShipsSunk()||alert("You win!"),this.#P.forEach((t=>{const e=this.#O.get(t);e&&(t.removeEventListener("click",e),this.#O.delete(t))})),void this.#D.classList.add("hide");if(this.#y.allShipsSunk())return;const s=this.#b.smartAttack(),a=this.#y.receiveAttack(s.x,s.y),l=this.#z[10*s.y+s.x];"miss"==a?l.classList.add("miss"):l.classList.add("hit"),this.#b.update(a),this.#y.allShipsSunk()&&alert("Computer wins!")}#J(){const t=this.#M.x,e=this.#M.y;for(let i=0;i<this.#M.size;i++)this.#M.isVertical?this.#z[10*(e+i)+t].classList.remove("ship-placing"):this.#z[10*e+t+i].classList.remove("ship-placing")}#K(){const t=this.#M.x,e=this.#M.y;for(let i=0;i<this.#M.size;i++)this.#M.isVertical?this.#z[10*(e+i)+t].classList.add("ship-placing"):this.#z[10*e+t+i].classList.add("ship-placing")}}document.addEventListener("DOMContentLoaded",(()=>{document.querySelector("#reset").addEventListener("click",(()=>{location.reload()})),new S}))})();